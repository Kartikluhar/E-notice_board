{% extends 'base.html' %}
{% comment %} admin_list_student.html {% endcomment %}

{% block title %}
  Student List | E-Notice Board
{% endblock %}

{% block content %}
<section class="py-5">
  <div class="container">

    <!-- Page Title -->
    <h1 class="text-center mb-2" style="color:#004b87;">
      Student List
    </h1>
    <p class="text-center text-muted mb-5">
      Manage all registered students here
    </p>

    <!-- Top Buttons -->
    <div class="d-flex flex-wrap justify-content-center gap-3 mb-5">
      <a
        href="{% url 'add_student' %}"
        class="btn btn-outline-primary"
      >
        + Add New Student
      </a>
      <a
        href="{% url 'admin_dboard' %}"
        class="btn btn-outline-info"
      >
        Back to Dashboard
      </a>
    </div>

    <!-- Filter & Search -->
<form method="get" class="row g-3 mb-4 justify-content-center">

  <!-- Search -->
  <div class="col-md-4">
    <input
      type="text"
      name="search"
      class="form-control"
      placeholder="Search by name, email or enrollment"
      value="{{ request.GET.search }}"
    />
  </div>

  <!-- Department Filter -->
  <div class="col-md-3">
    <select name="department" class="form-select">
      <option value="">All Departments</option>
      {% for dept in departments %}
        <option
          value="{{ dept.id }}"
          {% if request.GET.department == dept.id|stringformat:"s" %}selected{% endif %}
        >
          {{ dept.d_name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <!-- Semester Filter -->
  <div class="col-md-2">
    <select name="sem" class="form-select">
      <option value="">All Sem</option>
      {% for i in "12345678" %}
        <option
          value="{{ i }}"
          {% if request.GET.sem == i %}selected{% endif %}
        >
          Sem {{ i }}
        </option>
      {% endfor %}
    </select>
  </div>

  <!-- Buttons -->
  <div class="col-md-3 d-flex gap-2">
    <button type="submit" class="btn btn-primary w-100">
      Filter
    </button>
    <a href="{% url 'student_list' %}" class="btn btn-secondary w-100">
      Reset
    </a>
  </div>

</form>

    <!-- Student Table Card -->
    <div class="card">
      <div
        class="card-header d-flex justify-content-between align-items-center"
        style="background-color:#e0f0ff;"
      >
        <h5 class="mb-0" style="color:#004b87;">
          All Students
        </h5>
        <a
          href="{% url 'add_student' %}"
          class="btn btn-sm btn-primary"
        >
          + Add Student
        </a>
      </div>

      <div class="table-responsive">
        <table class="table table-striped table-hover mb-0">
          <thead>
            <tr>
              <th>Enrollment No</th>
              <th>Email</th>
              <th>Full Name</th>
              <th>Department</th>
              <th>Sem</th>
              <th>Role</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>

          <tbody>
            {% for student in students %}
            <tr>
              <td>{{ student.enrollment_no }}</td>
              <td>{{ student.email }}</td>
              <td>{{ student.full_name }}</td>
              <td>{{ student.department.d_name }}</td>
              <td>{{ student.sem }}</td>
              <td>{{ student.role }}</td>

              <td class="text-center">
                <a
                  href="{% url 'update_student' student.id %}"
                  class="btn btn-sm btn-info me-2"
                >
                  Edit
                </a>
                <a
                  href="{% url 'delete_student' student.id %}"
                  class="btn btn-sm btn-danger"
                >
                  Delete
                </a>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="5" class="text-center">
                No students available.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>
</section>
{% endblock %}
